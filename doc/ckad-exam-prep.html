<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-05-24 Mon 09:49 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CKAD Exam Prep</title>
<meta name="author" content="Nandaja Varma" />
<meta name="generator" content="Org Mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="content">
<h1 class="title">CKAD Exam Prep</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org97f69e6">Prep Checklist</a></li>
<li><a href="#orgbfaadb0">Tips and tricks</a></li>
<li><a href="#org8063fb6">Lecture notes</a>
<ul>
<li><a href="#org98bcb3f">Security contexts</a></li>
<li><a href="#orgd6ea175">Service accounts are used to authorize deployments, apis and people. RBAC can be used to authenticate.</a></li>
<li><a href="#orgba8e151">Resouce requests</a></li>
<li><a href="#orgc7e38e0">Taints and tolerations</a></li>
<li><a href="#org1f95787">Node selector</a></li>
<li><a href="#org33021c7">Node affinity and anti-affinity</a></li>
<li><a href="#orgc58046c">Multipod patterns</a></li>
<li><a href="#org5257481">Observability</a>
<ul>
<li><a href="#org27b04b0">Readiness probe:</a></li>
<li><a href="#org2e51dcf">Liveness probe</a></li>
<li><a href="#org8b35884">Logging</a></li>
<li><a href="#orgfc7e6d7">Monitoring metrics</a></li>
<li><a href="#org37364fe">Labels and selectors</a></li>
<li><a href="#orgf3058ab">Rollbacks and upgrades</a></li>
<li><a href="#org5ee0e89">Types of workloads</a></li>
</ul>
</li>
<li><a href="#org0f6470a">Services</a></li>
</ul>
</li>
</ul>
</div>
</div>
<p>
I am  documenting my preparations, materials and steps followed for CKAD exam in
this doc.
</p>

<div id="outline-container-org97f69e6" class="outline-2">
<h2 id="org97f69e6">Prep Checklist</h2>
<div class="outline-text-2" id="text-org97f69e6">
</div>
<ul class="org-ul">
<li><a id="orge1e5c28"></a><span class="done DONE">DONE</span> following <a href="https://www.udemy.com/course/certified-kubernetes-application-developer/">this course on udemy</a>.<br /></li>
<li><a id="org1bbf0d1"></a><span class="todo TODO">TODO</span> notes to read <code>[/]</code><br />
<ul class="org-ul">
<li><a id="org22044e2"></a><span class="todo ___">[ ]</span> CKAD notes 1 <a href="https://github.com/saaguero/ckad-notes">here</a><br /></li>
<li><a id="org639b5fd"></a><span class="todo ___">[ ]</span> CKAD notes 2 <a href="https://github.com/lucassha/CKAD-resources">here</a><br /></li>
</ul>
</li>
<li><a id="org7ce2f18"></a><span class="todo TODO">TODO</span> solve more challenges <code>[/]</code><br />
<ul class="org-ul">
<li><a id="org6f3799f"></a><span class="todo ___">[ ]</span> <a href="https://github.com/dgkanatsios/CKAD-exercises">the git repo</a> full of problems<br /></li>
<li><a id="org1849870"></a><span class="todo ___">[ ]</span> <a href="https://www.katacoda.com/liptanbiswas/courses/ckad-practice-challenges">this katakode</a><br /></li>
<li><a id="org682aac7"></a><span class="todo ___">[ ]</span> <a href="https://github.com/twajr/ckad-prep-notes#tasks-from-kubernetes-doc">one more git repo</a><br /></li>
</ul>
</li>
</ul>
</div>
<div id="outline-container-orgbfaadb0" class="outline-2">
<h2 id="orgbfaadb0">Tips and tricks</h2>
<div class="outline-text-2" id="text-orgbfaadb0">
<p>
Reference from <a href="https://www.linkedin.com/pulse/my-ckad-exam-experience-atharva-chauthaiwale/">this</a> blogpost
</p>
<ol class="org-ol">
<li>Go through the above git repo</li>
<li><p>
Install tmux and remap the leader key
</p>

<div class="org-src-container">
<pre class="src src-bash">   unbind C-b
   set-option -g prefix C-a
   bind-key C-a send-prefix
</pre>
</div></li>
<li><p>
Alias bash stuff
</p>
<div class="org-src-container">
<pre class="src src-bash">   <span style="color: #3679D8;">export</span> <span style="color: #86e7d7;">ns</span>=default
   <span style="color: #3679D8;">alias</span> <span style="color: #86e7d7;">k</span>=<span style="color: #79D836;">'kubectl'</span> <span style="color: #767676; font-style: italic;"># </span><span style="color: #767676; font-style: italic;">This helps when namespace in question doesn't have a friendly name</span>
   <span style="color: #3679D8;">alias</span> <span style="color: #86e7d7;">kns</span>=<span style="color: #79D836;">'kubectl -n $ns'</span>
   <span style="color: #3679D8;">alias</span> <span style="color: #86e7d7;">kdr</span>= <span style="color: #79D836;">'kubectl -n $ns -o yaml --dry-run'</span>.  <span style="color: #767676; font-style: italic;"># </span><span style="color: #767676; font-style: italic;">run commands in dry run mode and generate yaml.</span>
   <span style="color: #3679D8;">echo</span> &#8216;source &lt;<span style="color: #3679D8;">(</span>kubectl completion bash<span style="color: #3679D8;">)</span>&#8217; &gt;&gt; ~/.bashrc
</pre>
</div>

<p>
Set vimrc with
</p>
<div class="org-src-container">
<pre class="src src-bash">   <span style="color: #3679D8;">set</span> nu
   <span style="color: #3679D8;">set</span> <span style="color: #86e7d7;">ts</span>=<span style="color: #D85F00; font-weight: bold;">2</span>
   <span style="color: #3679D8;">set</span> <span style="color: #86e7d7;">sw</span>=<span style="color: #D85F00; font-weight: bold;">2</span>
   <span style="color: #3679D8;">set</span> et
</pre>
</div></li>
<li>Learn how to use <a href="https://medium.com/@atharvac.cloud/kubernetes-deep-dive-part-3-generators-for-quick-poc-6cac698f08eb">run and generator commands properly</a></li>
<li>Bookmark important k8s doc links</li>
<li>The above bash scripts can be found <a href="https://kubernetes.io/docs/reference/kubectl/cheatsheet/">in this page of k8s doc</a>.</li>
</ol>
</div>
</div>


<div id="outline-container-org8063fb6" class="outline-2">
<h2 id="org8063fb6">Lecture notes</h2>
<div class="outline-text-2" id="text-org8063fb6">
<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2021-05-12 Wed&gt;</span></span>
</p>
</div>

<div id="outline-container-org98bcb3f" class="outline-3">
<h3 id="org98bcb3f">Security contexts</h3>
<div class="outline-text-3" id="text-org98bcb3f">
<p>
Containers are encapsulated in pods. The security contexts in pod will be taken by all containers. But settings in the container overrides pod security.
</p>
<div class="org-src-container">
<pre class="src src-yaml"><span style="color: #86e7d7;">securityContext</span>:
    <span style="color: #86e7d7;">runAsUser</span>: 1000
    <span style="color: #86e7d7;">capabilities</span>:
        <span style="color: #86e7d7;">add</span>: [<span style="color: #79D836;">"MAC_ADMIN"</span>]
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd6ea175" class="outline-3">
<h3 id="orgd6ea175">Service accounts are used to authorize deployments, apis and people. RBAC can be used to authenticate.</h3>
</div>
<div id="outline-container-orgba8e151" class="outline-3">
<h3 id="orgba8e151">Resouce requests</h3>
<div class="outline-text-3" id="text-orgba8e151">
<p>
By default the resource request is 0.5 CPU and 256mb of RAM
</p>
<div class="org-src-container">
<pre class="src src-yaml"><span style="color: #86e7d7;">containers</span>:
    <span style="color: #86e7d7;">resources</span>:
        <span style="color: #86e7d7;">requests</span>:
          <span style="color: #86e7d7;">memory</span>: <span style="color: #79D836;">"1Gi"</span>
          <span style="color: #86e7d7;">cpu</span>: 1
</pre>
</div>

<p>
vCPU - 1 count of cpu also 100m (milli)
</p>

<p>
Limits and requests are given to each container within the pod.
</p>
</div>
</div>
<div id="outline-container-orgc7e38e0" class="outline-3">
<h3 id="orgc7e38e0">Taints and tolerations</h3>
<div class="outline-text-3" id="text-orgc7e38e0">
<p>
We can taint a nod so pods that are not tolerant towards that taint can&rsquo;t be scheduled on it.
</p>

<p>
key=value:taint-effect
</p>

<p>
taint-effect:
</p>
<ul class="org-ul">
<li>NoSchedule</li>
<li>PreferNoschedule</li>
<li>NoExecute</li>
</ul>

<div class="org-src-container">
<pre class="src src-yaml"><span style="color: #86e7d7;">spec</span>:
    <span style="color: #86e7d7;">tolerations</span>:
      - <span style="color: #86e7d7;">key</span>: <span style="color: #79D836;">"app"</span>
        <span style="color: #86e7d7;">operator</span>: <span style="color: #79D836;">"Equal"</span>
        <span style="color: #86e7d7;">value</span>: <span style="color: #79D836;">"blue"</span>
        <span style="color: #86e7d7;">effect</span>: <span style="color: #79D836;">"NoSchedule"</span>
</pre>
</div>

<p>
<span class="timestamp-wrapper"><span class="timestamp">&lt;2021-05-13 Thu&gt;</span></span>
</p>
</div>
</div>
<div id="outline-container-org1f95787" class="outline-3">
<h3 id="org1f95787">Node selector</h3>
<div class="outline-text-3" id="text-org1f95787">
<p>
We can give label too the node and then ask the pods to be scheduled specifically on them
</p>

<div class="org-src-container">
<pre class="src src-bash">kubectl label node node01 <span style="color: #86e7d7;">size</span>=large
</pre>
</div>

<div class="org-src-container">
<pre class="src src-yaml"><span style="color: #86e7d7;">nodeSelector</span>:
   <span style="color: #86e7d7;">size</span>: large
</pre>
</div>
</div>
</div>

<div id="outline-container-org33021c7" class="outline-3">
<h3 id="org33021c7">Node affinity and anti-affinity</h3>
<div class="outline-text-3" id="text-org33021c7">
<p>
Ensure that nodes are scheduled in partiicular nodes. With affinity we can provide advanced specs.
It is for the whole pod.
</p>


<div class="org-src-container">
<pre class="src src-yaml"><span style="color: #86e7d7;">affinity</span>:
   <span style="color: #86e7d7;">nodeAffinity</span>:
     <span style="color: #86e7d7;">requiredDuringSchedulingIgnoredDuringExecution</span>:
        <span style="color: #86e7d7;">nodeSelectorTerms</span>:
            <span style="color: #86e7d7;">matchExpressions</span>:
                <span style="color: #86e7d7;">key</span>: size
                <span style="color: #86e7d7;">operator</span>: NotIn
                <span style="color: #86e7d7;">values</span>:
                - small
</pre>
</div>

<p>
type of node affinity:
</p>
<ul class="org-ul">
<li>requiredDuringSchedulingIgnoredDuringExecution</li>
<li>preferredDuringSchedulingIgnoredDuringExecution</li>
</ul>

<p>
during scheduling: when created
during execution: while the pod is running. if the node label is changed, etc.
</p>
</div>
</div>

<div id="outline-container-orgc58046c" class="outline-3">
<h3 id="orgc58046c">Multipod patterns</h3>
<div class="outline-text-3" id="text-orgc58046c">
<p>
Sidecar, adapter, a-something
</p>
</div>
</div>
<div id="outline-container-org5257481" class="outline-3">
<h3 id="org5257481">Observability</h3>
<div class="outline-text-3" id="text-org5257481">
<p>
Pod status - pending, container creating, running,
pod conditions: k describe
although the pod is ready the app might not be. The service depends on the
condition of the container to route traffic.
</p>
</div>
<div id="outline-container-org27b04b0" class="outline-4">
<h4 id="org27b04b0">Readiness probe:</h4>
<div class="outline-text-4" id="text-org27b04b0">
<div class="org-src-container">
<pre class="src src-yaml"><span style="color: #86e7d7;">readinessProbe</span>:
   <span style="color: #86e7d7;">httpGet</span>:
      <span style="color: #86e7d7;">path</span>: /etc/hosts
      <span style="color: #86e7d7;">port</span>: 8080
</pre>
</div>
</div>
</div>
<div id="outline-container-org2e51dcf" class="outline-4">
<h4 id="org2e51dcf">Liveness probe</h4>
<div class="outline-text-4" id="text-org2e51dcf">
<p>
k8s restarts the container as soon as the app restarts. What if the app is up
but it is actually stuck in an infinite loop. We can ping an endpoint to check
if the app is actually healthy.
</p>
<div class="org-src-container">
<pre class="src src-yaml"><span style="color: #86e7d7;">livenessProbe</span>:
   <span style="color: #86e7d7;">httpGet</span>:
      <span style="color: #86e7d7;">path</span>: /etc/hosts
      <span style="color: #86e7d7;">port</span>: 8080
</pre>
</div>
</div>
</div>
<div id="outline-container-org8b35884" class="outline-4">
<h4 id="org8b35884">Logging</h4>
<div class="outline-text-4" id="text-org8b35884">
<p>
k logs command etc.
</p>
</div>
</div>
<div id="outline-container-orgfc7e6d7" class="outline-4">
<h4 id="orgfc7e6d7">Monitoring metrics</h4>
<div class="outline-text-4" id="text-orgfc7e6d7">
<p>
metric server
prometheus
elastic stack
</p>
</div>

<ul class="org-ul">
<li><a id="org69521f4"></a>Metric server<br />
<div class="outline-text-6" id="text-org69521f4">
<p>
one metric server per cluster
</p>

<p>
retrieves metrics and consolidates. It keeps everything in memory. k8s runs
kubelet in each machine. Kubelet has cAdviser to send the mertrics.
</p>

<div class="org-src-container">
<pre class="src src-bash">kubectl top node
</pre>
</div>
</div>
</li>
</ul>
</div>
<div id="outline-container-org37364fe" class="outline-4">
<h4 id="org37364fe">Labels and selectors</h4>
<div class="outline-text-4" id="text-org37364fe">
<p>
Standard method to group to together.
Eg: dividing animals into groups
</p>
<div class="org-src-container">
<pre class="src src-yaml"><span style="color: #86e7d7;">metadata</span>:
    <span style="color: #86e7d7;">labels</span>:
        <span style="color: #86e7d7;">app</span>: App1
        <span style="color: #86e7d7;">function</span>: front-end
<span style="color: #86e7d7;">spec</span>:
     <span style="color: #86e7d7;">selector</span>:
        <span style="color: #86e7d7;">matchLabels</span>:
           <span style="color: #86e7d7;">app</span>: App1
    <span style="color: #86e7d7;">templates</span>:

</pre>
</div>

<p>
Selector matches the container labels
</p>
</div>
</div>

<div id="outline-container-orgf3058ab" class="outline-4">
<h4 id="orgf3058ab">Rollbacks and upgrades</h4>
<div class="outline-text-4" id="text-orgf3058ab">
<p>
rollout &amp; versioning:
</p>
<ul class="org-ul">
<li><p>
when a deployment is created, a rollout is triggered. the next time a new
revision is created
</p>
<div class="org-src-container">
<pre class="src src-bash">  k rollout status deploy/scops

  k rollout history deploy/scops
</pre>
</div>

<p>
To avoid runtime, we do rolling update strategy.(this is the default)
</p>

<p>
to change the images
</p>

<div class="org-src-container">
<pre class="src src-bash">  k set image command
</pre>
</div>

<p>
when a new deployment is created, it first creats the replicaser first. then
add the containers one by one.
</p>

<div class="org-src-container">
<pre class="src src-bash">  k rollout undo deploy/scops
</pre>
</div></li>
</ul>
</div>
</div>
<div id="outline-container-org5ee0e89" class="outline-4">
<h4 id="org5ee0e89">Types of workloads</h4>
<div class="outline-text-4" id="text-org5ee0e89">
<p>
Kubernetes restarts if the command exists. This is because the restartPolicy is
Always. For batch processing, we use Jobs. Similar to ReplicaSet but it runs a
bunch of pods to completion.
</p>

<div class="org-src-container">
<pre class="src src-yaml"><span style="color: #86e7d7;">apiVersion</span>: batch/v1
<span style="color: #86e7d7;">spec</span>:
<span style="color: #767676; font-style: italic;"># </span><span style="color: #767676; font-style: italic;">3 job completions</span>
    <span style="color: #86e7d7;">completions</span>: 3
</pre>
</div>
</div>
<ul class="org-ul">
<li><a id="orgc1df131"></a>Cronjobs<br />
<div class="outline-text-5" id="text-orgc1df131">
<p>
batch/v1beta1
</p>

<div class="org-src-container">
<pre class="src src-yaml"><span style="color: #86e7d7;">spec</span>:
    <span style="color: #86e7d7;">schedule</span>:
    <span style="color: #86e7d7;">jobTemplate</span>:
        <span style="color: #86e7d7;">spec</span>:
</pre>
</div>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-org0f6470a" class="outline-3">
<h3 id="org0f6470a">Services</h3>
<div class="outline-text-3" id="text-org0f6470a">
<p>
Aspects of networking
</p>
</div>
<ul class="org-ul">
<li><a id="org01e69fd"></a>External access:<br />
<div class="outline-text-5" id="text-org01e69fd">
<p>
k8s pod has an IP address
pod network has an IP
pod has an IP
</p>

<p>
NodePort is an object that listens to port on the cluser and map it to the cotainer.
</p>

<p>
ClsuterIP
The service creates a virtualIP connecting between a set of front end IPs and
backend IPs
</p>

<p>
Loadbalancer
</p>
</div>

<ul class="org-ul">
<li><a id="orgbd7c42a"></a>NodePort<br />
<div class="outline-text-6" id="text-orgbd7c42a">
<p>
targetPort - port on the pod
NodePort: port on the node, in the range of 300000 - 32767
port - port on the service object.
port is the only mandatory thing
</p>
<div class="org-src-container">
<pre class="src src-yaml">    <span style="color: #86e7d7;">spec</span>:
       <span style="color: #86e7d7;">type</span>: NodePort
       <span style="color: #86e7d7;">ports</span>:
          - <span style="color: #86e7d7;">targetPort</span>: 80
            <span style="color: #86e7d7;">port</span>: 80
            <span style="color: #86e7d7;">nodePort</span>: 30008
        <span style="color: #86e7d7;">selector</span>:
          <span style="color: #86e7d7;">app</span>: myapp
          <span style="color: #86e7d7;">type</span>: front-end
</pre>
</div>
<p>
service acts as a built in loadbalancer
</p>
</div>
</li>
<li><a id="org3502f26"></a>ClusterIp<br />
<div class="outline-text-6" id="text-org3502f26">
<p>
we have different tier of services: front-end, backend, redis. this IP is
accessible from only inside the cluster. It kinda groups the services together.
</p>
</div>
</li>
<li><a id="org1e5d5d3"></a>Ingress<br />
<div class="outline-text-6" id="text-org1e5d5d3">
<p>
Expose ingress controller as a loadbalancer
You install ingress controller and create ingress resources.
</p>
</div>
</li>
<li><a id="org2dfaaf8"></a>Network policy<br />
<div class="outline-text-6" id="text-org2dfaaf8">
<p>
Ingress and Egress trafic,
you can attach network policy to each pod.
all network solution doesn&rsquo;t support network policy
</p>
</div>
</li>
</ul>
</li>
<li><a id="org91682ba"></a>Persistant volume<br />
<div class="outline-text-5" id="text-org91682ba">
<p>
Persistant volumes are blocks of storage allocated for the clusters
PVC claims a chunk for a node
admin creates pv and user creates PVC
1-1 relationship between pv and pvc
</p>


<p>
accessmodes
</p>

<p>
we can set the volume to be deleted or retained when claim is deleted(default: retain)
</p>
</div>
</li>
</ul>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Nandaja Varma</p>
<p class="date">Created: 2021-05-24 Mon 09:49</p>
</div>
</body>
</html>
